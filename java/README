From here on follows implementation in Java.
