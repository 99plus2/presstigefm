From here on follows implementation in C++.
