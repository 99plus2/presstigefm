From here on follows implementation in C#.
Everything is build on .NET 4.x and Visual Studio 10.
